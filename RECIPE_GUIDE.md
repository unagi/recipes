# レシピ作成ガイド

このドキュメントは、AIエージェントがレシピを作成・編集する際の完全なガイドです。

## 目次

1. [レシピ追加の手順](#レシピ追加の手順)
2. [ファイル命名規則](#ファイル命名規則)
3. [recipeType選択基準](#recipetype選択基準)
4. [フィールド記入ガイド](#フィールド記入ガイド)
5. [Markdown本文の構造](#markdown本文の構造)
6. [外部ソースからの抽出ルール](#外部ソースからの抽出ルール)
7. [よくあるケースの対処法](#よくあるケースの対処法)
8. [トラブルシューティング](#トラブルシューティング)

---

## レシピ追加の手順

### 1. 情報収集
- 外部ソース（Cookpadなど）のURLまたはテキストを確認
- レシピ名、材料、手順、調理時間を抽出

### 2. recipeTypeの決定
- [recipeType選択基準](#recipetype選択基準)を参照して決定
- `dish`か`ingredient`かで必須フィールドが変わる

### 3. ファイル作成
- ファイル名: `src/content/recipes/{kebab-case}.md`
- [ファイル命名規則](#ファイル命名規則)に従う

### 4. frontmatterの記述
- すべての必須フィールドを記入
- [フィールド記入ガイド](#フィールド記入ガイド)を参照

### 5. Markdown本文の記述
- [Markdown本文の構造](#markdown本文の構造)を参照
- 最低限「## レシピのポイント」セクションは含める

### 6. ビルド確認
```bash
npm run build
```
- エラーが出た場合は[トラブルシューティング](#トラブルシューティング)を参照

### 7. テスト実行（該当する場合）
```bash
npm run test:run
```

---

## ファイル命名規則

### 基本ルール
- **ケバブケース（kebab-case）を使用**
- **英語表記**
- **説明的で検索しやすい名前**
- **最大3-4単語程度**

### 命名例

| レシピ名 | ファイル名 | 理由 |
|---------|-----------|------|
| 焦がしたまねぎのシンプルパスタ | `caramelized-onion-pasta.md` | 主要な特徴を表現 |
| スパイスから作るスープカレー | `spice-soup-curry.md` | 特徴（スパイス）+ 料理名 |
| イージースモーカーでつくる即席ベーコン | `easy-smoker-bacon.md` | 調理法 + 食材名 |
| 基本のトマトソース | `basic-tomato-sauce.md` | レベル + 食材名 |
| 鶏がらスープ | `chicken-stock.md` | 英語標準名 |
| 自家製マヨネーズ | `homemade-mayonnaise.md` | 修飾語 + 食材名 |

### 避けるべき命名
- ❌ `recipe1.md` - 説明的でない
- ❌ `焦がしたまねぎパスタ.md` - 日本語
- ❌ `caramelized_onion_pasta.md` - スネークケース
- ❌ `CaramelizedOnionPasta.md` - パスカルケース

---

## recipeType選択基準

### フローチャート

```
そのまま食べられる完成した料理か？
  ├─ YES → dish
  └─ NO  → 他の料理の材料・調味料として使うか？
            ├─ YES → 以下から選択
            │        - ingredient（加工食材：ベーコン、チャーシュー等）
            │        - sauce（ソース：トマトソース、ホワイトソース等）
            │        - stock（出汁：鶏がらスープ、コンソメ等）
            │        - condiment（調味料：自家製マヨネーズ、ドレッシング等）
            │        - preserve（保存食：ジャム、ピクルス等）
            └─ NO  → dish（まずは食べられる料理なので）
```

### 具体的な選択基準

#### `dish` - 料理
- **定義**: そのまま食卓に出せる完成した料理
- **必須フィールド**: `servings`（人数）
- **例**: パスタ、カレー、サラダ、スープ、メインディッシュ

#### `ingredient` - 加工食材
- **定義**: 他の料理の材料として使う加工食品
- **任意フィールド**: `yield`（できあがり量）
- **例**: ベーコン、チャーシュー、燻製肉、塩麹、発酵食品

#### `sauce` - ソース
- **定義**: 料理にかける・和える液状の調味料
- **任意フィールド**: `yield`（できあがり量）
- **例**: トマトソース、ホワイトソース、デミグラスソース、タレ

#### `stock` - 出汁・スープベース
- **定義**: 料理のベースとなる液体
- **任意フィールド**: `yield`（できあがり量）
- **例**: 鶏がらスープ、野菜スープ、コンソメ、だし汁

#### `condiment` - 調味料
- **定義**: 少量使う調味料・ドレッシング
- **任意フィールド**: `yield`（できあがり量）
- **例**: 自家製マヨネーズ、ドレッシング、香辛料ミックス

#### `preserve` - 保存食
- **定義**: 長期保存を目的とした加工食品
- **任意フィールド**: `yield`（できあがり量）
- **例**: ジャム、ピクルス、コンポート、マリネ

### 判断に迷うケース

| ケース | recipeType | 理由 |
|--------|-----------|------|
| ハンバーグ（単体で食べる） | `dish` | 完成した料理 |
| ミートソース | `sauce` | パスタにかける前提 |
| ラーメンスープ | `stock` | 麺料理のベース |
| チャーシュー（ラーメン用） | `ingredient` | トッピング材料 |
| ポテトサラダ | `dish` | 単体で食べられる |
| 自家製ベーコン | `ingredient` | 他の料理の材料 |

---

## フィールド記入ガイド

### 必須フィールド

#### `title`（文字列）
- **ルール**:
  - 日本語で記述
  - 【本格】【簡単】などの接頭辞は任意
  - 最大50文字程度
- **例**:
  ```yaml
  title: "【本格】スパイスから作るスープカレー"
  title: "焦がしたまねぎのシンプルパスタ"
  title: "イージースモーカーでつくる即席ベーコン"
  ```

#### `description`（文字列）
- **ルール**:
  - レシピの特徴を1-2文で説明
  - 最大150文字程度
  - 「〜です。」で終わる丁寧な文体
- **例**:
  ```yaml
  description: "旨味調味料不使用ながらも、コクのあるスープカレーです。鶏がらスープとソフリットは若干面倒ですが、冷凍保存可能です"
  ```

#### `recipeType`（列挙型）
- **ルール**: [recipeType選択基準](#recipetype選択基準)に従って選択
- **選択肢**: `dish` | `ingredient` | `sauce` | `stock` | `condiment` | `preserve`

#### `servings`（数値、dishのみ必須）
- **ルール**:
  - `recipeType: "dish"`の場合は必須
  - 正の整数（1人分、2人分、4人分など）
- **例**:
  ```yaml
  servings: 2
  servings: 4
  ```

#### `yield`（オブジェクト、dish以外で使用）
- **ルール**:
  - `amount`（単一値）または `min`+`max`（レンジ）のいずれかが必須
  - `unit`は必須（g、ml、個、枚など）
- **単一値の例**:
  ```yaml
  yield:
    amount: 500
    unit: "ml"
  ```
- **レンジの例**（調理中の脱水・蒸発で量が変わる場合）:
  ```yaml
  yield:
    min: 375
    max: 425
    unit: "g"
  ```

#### `ingredients`（配列）
- **ルール**:
  - **経口摂取するもののみ**（道具は`equipment`へ）
  - `name`: 材料名
  - `amount`: 分量（"500g"、"大さじ2"、"適量"など）
  - `group`（任意）: グループ名（材料が多い場合に使用）
- **例**:
  ```yaml
  ingredients:
    - name: "スパゲティ（1.6mm）"
      amount: "200g"
    - name: "玉ねぎ"
      amount: "1個（中サイズ）"
    - name: "クミン"
      amount: "大さじ2"
      group: "スパイス"
  ```

#### `steps`（配列）
- **ルール**:
  - 調理手順を順番に記載
  - 各ステップは1文で完結させる
  - 「〜する」で終わる
- **例**:
  ```yaml
  steps:
    - "大きめの鍋にたっぷりの水を沸かし、塩を加える"
    - "にんにくを薄切りにする"
    - "フライパンにオリーブオイルとにんにくを入れて弱火で加熱する"
  ```

#### `publishedDate`（日付）
- **ルール**:
  - YYYY-MM-DD形式
  - レシピ作成日を記載
- **例**:
  ```yaml
  publishedDate: 2024-01-16
  ```

### 任意フィールド

#### `prepTime`（数値、分）
- **ルール**: 下準備時間（分単位）
- **例**:
  ```yaml
  prepTime: 30
  prepTime: 1440  # 24時間（漬け込み時間など）
  ```

#### `cookTime`（数値、分）
- **ルール**: 調理時間（分単位）
- **例**:
  ```yaml
  cookTime: 45
  ```

#### `equipment`（配列）
- **ルール**:
  - **経口摂取しないもの**（道具、器具、容器など）
  - 特殊な道具がある場合に記載
- **例**:
  ```yaml
  equipment:
    - "イージースモーカー（家庭用燻製機）"
    - "燻製用チップ（大さじ1）"
    - "ジップロック（密閉できる保存袋）"
  ```

#### `category`（文字列）
- **ルール**: 料理のカテゴリ（1つのみ）
- **例**:
  ```yaml
  category: "カレー"
  category: "パスタ"
  category: "燻製"
  ```

#### `tags`（配列）
- **ルール**: 検索用タグ（複数可）
- **例**:
  ```yaml
  tags: ["本格", "スパイス", "スープカレー", "北海道"]
  tags: ["シンプル", "節約", "ベジタリアン", "イタリアン"]
  ```

#### `difficulty`（列挙型）
- **ルール**: `easy` | `medium` | `hard`
- **例**:
  ```yaml
  difficulty: "medium"
  ```

#### `image`（文字列）
- **ルール**: 画像ファイルのパス（将来の拡張用）
- **例**:
  ```yaml
  image: "/images/recipes/spice-soup-curry.jpg"
  ```

#### `updatedDate`（日付）
- **ルール**: レシピ更新日（更新時のみ記載）
- **例**:
  ```yaml
  updatedDate: 2024-02-15
  ```

---

## Markdown本文の構造

### 必須セクション

#### `## レシピのポイント`
- **目的**: レシピの概要と特徴を説明
- **記載内容**: レシピの背景、特徴、おすすめポイント
- **例**:
  ```markdown
  ## レシピのポイント

  このレシピは、シンプルな材料で作れる本格的なイタリアンパスタです。
  ```

### 推奨セクション

#### `### コツ`
- **目的**: 成功のポイントを箇条書き
- **記載内容**: 失敗しやすい部分、重要な工程、味の決め手
- **例**:
  ```markdown
  ### コツ

  - **玉ねぎを焦がしすぎない**: きつね色になるまでじっくり炒める
  - **乳化が重要**: 茹で汁とオリーブオイルをしっかり乳化させる
  - **塩加減**: パスタの茹で汁に塩がしっかり入っていることが大切
  ```

### 任意セクション（レシピの種類に応じて追加）

#### `### 事前準備` / `### 必要な道具`
- **使用タイミング**: 複雑なレシピ、特殊な道具が必要な場合
- **例**:
  ```markdown
  ### 事前準備

  このレシピでは以下の材料を事前に準備しておくと便利です（冷凍保存可能）：

  **鶏がらスープの作り方**:
  1. 鶏ガラ1羽分を水で洗い、血合いを取り除く
  2. 大きめの鍋に鶏ガラ、水2リットル、長ネギの青い部分、生姜を入れる
  3. 強火で沸騰させ、アクを取り除く
  4. 弱火で2-3時間煮込む
  5. ザルで濾して完成（冷凍保存可能）
  ```

#### `### アレンジ`
- **使用タイミング**: バリエーションが豊富な料理
- **例**:
  ```markdown
  ### アレンジ

  - ベーコンやアンチョビを加えると、より旨味が増します
  - 仕上げにバターを加えるとコクが出ます
  - 唐辛子を加えてペペロンチーノ風にしても美味しいです
  ```

#### `### 保存方法`
- **使用タイミング**: `ingredient`、`sauce`、`preserve`など作り置きできるもの
- **例**:
  ```markdown
  ### 保存方法

  - 冷蔵保存: 3-5日
  - 冷凍保存: 1ヶ月（スライスしてラップで包んでから冷凍）
  ```

#### `### 使い方`
- **使用タイミング**: `ingredient`、`sauce`など他の料理に使う材料
- **例**:
  ```markdown
  ### 使い方

  - そのままスライスして: サンドイッチやサラダに
  - 加熱して: カルボナーラやパスタの具材に
  - 厚切りで: ステーキとして焼いても美味
  ```

#### `## 注意事項`
- **使用タイミング**: 安全上の注意が必要な場合
- **例**:
  ```markdown
  ## 注意事項

  - 燻製機の使用方法は、機種によって異なります。取扱説明書を確認してください
  - 室内で燻製する場合は、換気を十分に行ってください
  - 肉の中心温度が63°C以上になるよう、加熱時間を調整してください
  ```

#### `## 栄養情報`
- **使用タイミング**: 栄養成分が計算できる場合（将来の拡張）
- **例**:
  ```markdown
  ## 栄養情報（1人分・概算）

  - カロリー: 約450kcal
  - タンパク質: 約12g
  - 炭水化物: 約75g
  - 脂質: 約12g
  ```

#### `## トッピングのおすすめ`
- **使用タイミング**: カレー、ラーメンなどトッピングが重要な料理
- **例**:
  ```markdown
  ## トッピングのおすすめ

  - かぼちゃ（素揚げ）
  - なす（素揚げ）
  - ゆで卵または目玉焼き
  - 鶏もも肉（骨付き）
  ```

---

## 外部ソースからの抽出ルール

### Cookpadからの抽出

#### 基本方針
- **尊重**: オリジナルレシピの意図を尊重
- **忠実**: 材料や手順は原則として変更しない
- **補完**: 不明確な部分は常識的に補完

#### 抽出ルール

##### 1. タイトル
- Cookpadのタイトルをベースに、必要に応じて【本格】【簡単】などを追加
- 原則として元のタイトルを尊重

##### 2. 材料
- **分量表記の統一**:
  - "大さじ1" → そのまま
  - "1個" → "1個（中サイズ）"など補足を追加可
  - "適量" → そのまま（無理に数値化しない）
- **グループ分け**:
  - 材料が10個以上の場合、意味のあるグループに分ける
  - 例: "スパイス"、"調味料"、"スープベース"、"トッピング"

##### 3. 手順
- Cookpadの手順番号に従う
- 各ステップは「〜する」で終わる
- 長い手順は適宜分割

##### 4. 調理時間
- Cookpadに記載がある場合はそのまま使用
- 記載がない場合:
  - `prepTime`: 下準備が必要な場合のみ記載（漬け込み時間など）
  - `cookTime`: 実際の加熱時間のみ記載

##### 5. 難易度
- Cookpadに記載がある場合は参考にする
- 記載がない場合は以下の基準で判断:
  - `easy`: 材料5個以下、手順5個以下、特殊な道具不要
  - `medium`: 材料10個前後、手順10個前後、一般的な道具
  - `hard`: 材料15個以上、手順15個以上、特殊な道具必要

##### 6. カテゴリとタグ
- **category**: 料理の主要カテゴリ1つ（カレー、パスタ、燻製など）
- **tags**: 複数可（本格、スパイス、節約、ベジタリアンなど）

### 他のソースからの抽出

- 基本方針はCookpadと同じ
- 著作権に配慮し、手順は自分の言葉で書き直す
- 出典を`description`または本文に記載することを検討

---

## よくあるケースの対処法

### 1. 分量が不明確な場合

#### ケース: "適量"、"お好み"
- **対処**: そのまま記載
- **例**:
  ```yaml
  - name: "塩"
    amount: "適量"
  - name: "唐辛子粉"
    amount: "お好み"
  ```

#### ケース: "少々"、"ひとつまみ"
- **対処**: そのまま記載
- **例**:
  ```yaml
  - name: "タイム"
    amount: "少々"
  - name: "塩"
    amount: "ひとつまみ"
  ```

#### ケース: "大きめ1個"、"中サイズ2個"
- **対処**: 括弧で補足
- **例**:
  ```yaml
  - name: "玉ねぎ"
    amount: "1個（大きめ）"
  - name: "じゃがいも"
    amount: "2個（中サイズ）"
  ```

### 2. 調理時間が可変の場合

#### ケース: "30分以上"
- **対処**: 最小時間を記載、本文で説明
- **例**:
  ```yaml
  cookTime: 30
  ```
  ```markdown
  ### コツ
  - **煮込み時間**: 30分以上煮込むことで、スパイスの香りと旨味が十分に抽出されます
  ```

#### ケース: 下準備に長時間（漬け込み等）
- **対処**: `prepTime`に記載
- **例**:
  ```yaml
  prepTime: 1440  # 24時間
  cookTime: 50
  ```

### 3. 材料と道具の区別

#### 原則
- **経口摂取するもの** → `ingredients`
- **経口摂取しないもの** → `equipment`

#### 判断に迷うケース

| 項目 | 分類 | 理由 |
|-----|------|------|
| 燻製用チップ | `equipment` | 煙になるだけで食べない |
| ラップ、ジップロック | `equipment` | 道具 |
| クッキングシート | `equipment` | 道具 |
| パスタの茹で汁 | `ingredients` | 料理に使う |
| 揚げ油 | `ingredients` | 一部が料理に残る |
| 竹串（串焼き用） | `equipment` | 食べない（刺すだけ） |
| 爪楊枝（盛り付け用） | `equipment` | 食べない |

### 4. yieldの決定

#### ケース: 正確な量がわかる
- **対処**: `amount`を使用
- **例**:
  ```yaml
  yield:
    amount: 500
    unit: "ml"
  ```

#### ケース: 調理中に脱水・蒸発する
- **対処**: レンジ表記（`min`と`max`）を使用
- **例**:
  ```yaml
  yield:
    min: 375
    max: 425
    unit: "g"
  ```
- **補足**: 本文で元の材料の量を説明
  ```markdown
  豚バラブロック500gから、約375-425gのベーコンができます（調理中の脱水により約15-25%減少）。
  ```

#### ケース: 量が測定できない
- **対処**: `yield`フィールド自体を省略
- **例**: `recipeType: "ingredient"`でも`yield`は任意なので省略可

### 5. 複数の調理法がある場合

#### ケース: "フライパンまたはオーブンで"
- **対処**: 主要な方法を手順に記載、代替方法を本文に記載
- **例**:
  ```yaml
  steps:
    - "フライパンで中火で10分焼く"
  ```
  ```markdown
  ### アレンジ
  - オーブンで調理する場合: 180°Cで15分焼く
  ```

### 6. グループの使い方

#### 使用タイミング
- 材料が10個以上ある場合
- 意味のあるグループに分けられる場合

#### グループ名の例
- `スパイス`: スパイス類
- `調味料`: 塩、砂糖、醤油など
- `スープベース`: スープの基本材料
- `トッピング`: 最後にのせるもの
- `仕上げ`: 最後に加えるもの
- `メイン`: 主材料
- `ハーブ`: ハーブ類
- `野菜`: 野菜類

#### 例
```yaml
ingredients:
  - name: "豚バラブロック"
    amount: "500g"
    group: "メイン"
  - name: "塩"
    amount: "小さじ2"
    group: "調味料"
  - name: "セージ"
    amount: "2～3枚"
    group: "ハーブ"
```

---

## トラブルシューティング

### よくあるバリデーションエラー

#### エラー: "dish タイプの場合は servings（人数）が必須です"
- **原因**: `recipeType: "dish"`なのに`servings`が未記入
- **解決**:
  ```yaml
  recipeType: "dish"
  servings: 2  # 追加
  ```

#### エラー: "amount または (min と max) のいずれかが必須です"
- **原因**: `yield`に`amount`も`min`+`max`も記載されていない
- **解決** (単一値):
  ```yaml
  yield:
    amount: 500
    unit: "ml"
  ```
- **解決** (レンジ):
  ```yaml
  yield:
    min: 375
    max: 425
    unit: "g"
  ```

#### エラー: "ingredients は最低1つ必要です"
- **原因**: `ingredients`が空配列
- **解決**: 最低1つの材料を追加

#### エラー: "steps は最低1つ必要です"
- **原因**: `steps`が空配列
- **解決**: 最低1つの手順を追加

#### エラー: "publishedDate は必須です"
- **原因**: `publishedDate`が未記入
- **解決**:
  ```yaml
  publishedDate: 2024-01-16
  ```

### ビルドエラー

#### エラー: "Unexpected token"
- **原因**: YAMLの構文エラー（インデント、コロン、ダッシュなど）
- **解決**:
  - インデントを確認（スペース2つ）
  - `- `の後にスペースがあるか確認
  - `:`の後にスペースがあるか確認

#### エラー: "Expected string, received number"
- **原因**: 文字列フィールドに数値を記入
- **解決**: ダブルクォートで囲む
  ```yaml
  # ❌ 間違い
  amount: 2個

  # ✅ 正しい
  amount: "2個"
  ```

### その他の問題

#### 問題: レシピが表示されない
- **原因**: frontmatterの形式が間違っている
- **確認**:
  1. `---`で囲まれているか
  2. すべての必須フィールドが記入されているか
  3. `npm run build`でエラーが出ないか

#### 問題: 画像が表示されない
- **原因**: 画像パスが間違っている（将来の問題）
- **確認**:
  1. `public/images/recipes/`に画像があるか
  2. `image: "/images/recipes/xxx.jpg"`のパスが正しいか

---

## チェックリスト

### レシピ作成時の最終チェック

#### frontmatter
- [ ] `title`が記入されているか
- [ ] `description`が記入されているか
- [ ] `recipeType`が正しく選択されているか
- [ ] `dish`の場合、`servings`が記入されているか
- [ ] `ingredients`に最低1つ材料があるか
- [ ] 道具が`equipment`に分けられているか
- [ ] `steps`に最低1つ手順があるか
- [ ] `publishedDate`が記入されているか

#### Markdown本文
- [ ] `## レシピのポイント`セクションがあるか
- [ ] 最低1つの推奨セクション（`### コツ`など）があるか
- [ ] 必要に応じて注意事項が記載されているか

#### ビルド確認
- [ ] `npm run build`がエラーなく完了するか
- [ ] `npm run test:run`が通るか（該当する場合）

---

## 参考

- [SCHEMA.md](./SCHEMA.md) - スキーマの詳細仕様
- [AGENTS.md](./AGENTS.md) - 開発ガイド（TDD、Git等）
- [src/content/config.ts](./src/content/config.ts) - Zodスキーマ定義
- [サンプルレシピ](./src/content/recipes/) - 実際のレシピ例
